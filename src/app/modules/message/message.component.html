<div id="app">
  <aside class="sidebar">
    <header class="sidebar-header">
      <h2 class="title">Contatos</h2>
      <button (click)="openAddContactModal()" class="add-contact-btn">+ Adicionar Contato</button>
    </header>
    <div class="search-container">
      <input
        type="text"
        class="search-bar"
        placeholder="Pesquisar contatos..."
        [(ngModel)]="searchTerm"
      />
    </div>
    <ul class="contacts-list">
      <li
        *ngFor="let contact of filteredContacts"
        (click)="selectContact(contact.id)"
        [class.selected]="selectedContactId === contact.id"
      >
        <!-- Avatar ou placeholder -->
        <img
          *ngIf="contact.avatar"
          [src]="contact.avatar"
          [alt]="contact.name"
          class="contact-avatar"
        />
        <div *ngIf="!contact.avatar" class="contact-placeholder">
          {{ getInitials(contact.name) }}
        </div>
    
        <!-- Nome do contato -->
        <span class="contact-name">{{ contact.name }}</span>
      </li>
    </ul>    
  </aside>
  <main class="chat-container">
    <header class="chat-header">
      <div class="header-content">
        <!-- Avatar só é exibido se um contato estiver selecionado -->
        <div *ngIf="selectedContactId" class="header-avatar-container">
          <img
            *ngIf="getSelectedContact()?.avatar"
            [src]="getSelectedContact()?.avatar"
            [alt]="getSelectedContact()?.name"
            class="header-avatar"
          />
          <div *ngIf="!getSelectedContact()?.avatar" class="header-placeholder">
            {{ getInitials(getSelectedContact()?.name || '') }}
          </div>
        </div>
    
        <!-- Nome sempre exibido -->
        <div class="header-name">
          {{ getSelectedContact()?.name || 'Selecione um contato' }}
        </div>
      </div>
    </header>    
    <div class="chat-content">
      <div class="chat-messages" *ngIf="selectedContactId; else noContactSelected">
        <div
          *ngFor="let message of messages[selectedContactId]"
          [class.sent]="message.sender !== 'Você'"
          [class.received]="message.sender === 'Você'"
          class="message"
        >
          <p>{{ message.content }}</p>
          <small>{{ message.time }}</small>
        </div>
      </div>
      <footer class="chat-input" *ngIf="selectedContactId">
        <input type="text" [(ngModel)]="newMessage" placeholder="Digite sua mensagem..." />
        <button (click)="sendMessage()">Enviar</button>
      </footer>
    </div>
    <ng-template #noContactSelected>
      <div class="no-contact-container">
        <p class="no-contact-message">Nenhum contato selecionado.</p>
      </div>
    </ng-template>
  </main>
</div>
